name: Trigger Vercel Deploy

on:
  push:
    branches:
      - main  # 或你使用的主分支名称 (main/develop 等)
    paths:
      # 只在内容文件变化时触发,避免不必要的构建
      - 'posts/**'
      - 'spec/**'
      - 'data/**'
      - 'images/**'
  workflow_dispatch:  # 支持手动触发

jobs:
  trigger:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger Vercel Deploy Hook
        run: |
          response=$(curl -s -o /dev/null -w "%{http_code}" -X POST "${{ secrets.VERCEL_DEPLOY_HOOK }}")
          echo "Response code: $response"
          if [ "$code" -lt 200 ] || [ "$code" -ge 300 ]; then
            echo "Deploy hook failed with status: $code"
            exit 1
          fi